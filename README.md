# SkillRadar

SkillRadar — ETL-пайплайн для аналитики рынка труда.
Проект собирает вакансии с HH.ru, обогащает их данными, отправляет в Kafka, сохраняет в ClickHouse и предоставляет аналитику через Metabase.
Оркестрация процессов выполняется через Apache Airflow.

## История изменений

### v14: Scale Up & Fintech Fix (Current)
- **Масштабирование:** Расширен список мониторинга (Top-100 компаний в ключевых категориях: IT, Банки, Ритейл, Телеком).
- **Фильтрация:** Добавлен расширенный Stop-List для банковского сектора (исключение "представителей", "выездных менеджеров" и "специалистов по взысканию").
- **Рефакторинг:** Конфигурация Kafka вынесена в единый файл настроек, исправлены ошибки инициализации продюсера.
- **Очистка данных:** Внедрен механизм удаления нецелевых вакансий, пропущенных при первичном парсинге.

### v13: Deep Skill Mining (Stable)
- Реализован глубокий анализ навыков через регулярные выражения (Regex) по полному описанию вакансии.
- Внедрен словарь на 500+ технологий с учетом синонимов и сленга.
- Добавлена автоматическая категоризация вакансий (Backend, Frontend, DevOps и др.).

---

## Ключевые возможности

### 1. Deep Skill Mining (Глубокий анализ навыков)
В отличие от стандартных парсеров, система не доверяет только тегам, указанным работодателем. Анализируется полный текст описания вакансии.
- Распознавание версий, русских названий и аббревиатур.
- Выявление скрытых требований, не указанных в ключевых навыках.

### 2. Zen Mode (Инкрементальный парсинг)
- "Вежливый" режим сбора данных с динамическими паузами для обхода блокировок.
- Сохранение состояния (State Management): парсер запоминает дату последней вакансии по каждой компании.
- Игнорирование дублей и ранее обработанных записей.

### 3. Smart Filtering (Умная фильтрация)
- Многоуровневый список стоп-слов для отсеивания нецелевых вакансий (курьеры, массовый персонал, продажи, операторы).
- Специализированные фильтры для очистки IT-выдачи от банковского "поля".

### 4. Стабильность инфраструктуры
- Оптимизация под Docker Desktop и WSL 2.
- Защита от переполнения памяти (OOM) при больших нагрузках.
- Микросервисная архитектура с разделением ответственности.

---

## Архитектура

- **Airflow 2.7 + Postgres** — оркестрация задач и управление расписанием.
- **Kafka + Zookeeper** — буферизация потока данных.
- **ClickHouse** — колоночная БД для аналитики (движок ReplacingMergeTree).
- **Metabase** — визуализация данных.
- **Docker Compose** — управление контейнерами.

## Требования

- Docker Desktop (или Docker Engine)
- Docker Compose plugin
- Минимум 4GB RAM (рекомендуется 6GB)

---

## Инструкция по запуску

### 1. Инициализация

Выполните в корне проекта (только при первом запуске):

```bash
docker compose up airflow-init

2. Запуск стека
Запустите основные сервисы в фоновом режиме:

Bash

docker compose up -d
3. Проверка статуса
Убедитесь, что сервисы работают корректно:

Bash

docker compose ps
Ожидаемые сервисы:

skillradar_airflow_webserver

skillradar_airflow_scheduler

skillradar_postgres

skillradar_kafka

skillradar_clickhouse

skillradar_metabase

4. Доступ к интерфейсам
Airflow: http://localhost:8081 (Login: admin, Pass: admin)

Metabase: http://localhost:3000

ClickHouse: http://localhost:8123

5. Управление парсингом
Перейдите в интерфейс Airflow.

Найдите DAG skillradar_zen_v10.

Активируйте переключатель (Unpause).

При необходимости запустите вручную кнопкой Trigger DAG.

Полезные команды
Перезапуск планировщика (для применения изменений в коде):

Bash

docker compose restart airflow-scheduler
Остановка проекта:

Bash

docker compose stop
Просмотр логов:

Bash

docker compose logs -f airflow-scheduler
Очистка базы от мусора (пример запроса):

Bash

docker exec -it skillradar_clickhouse clickhouse-client -q "ALTER TABLE skill_radar.vacancies_categorized DELETE WHERE name ILIKE '%Представитель%'"